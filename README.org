#+TITLE: TREX I/O prototype library

* Installation
  This prototype uses  the EZFIO library generator,  which is provided
  as a submodule.  EZFIO requires  the IRPF90 code generator, which is
  also provided as a submodule.

  To clone this repository, use:

  #+BEGIN_SRC bash
git clone --recurse-submodules https://github.com/TREX-CoE/trex-io-prototype
  #+END_SRC

  then run
  #+BEGIN_SRC bash
./configure.sh
  #+END_SRC

  This step has  created the file named  =make.config=, which contains
  the configuration for the Makefiles.aNow edit this file to adapt the
  compiler and options to your computer.

  To modify the configuration of the library, modify the =trex.config=
  file.

  To build the library and the examples, run:

  #+BEGIN_SRC bash
make
  #+END_SRC

  and the library will be built in the =lib/= directory.

  #+BEGIN_IMPORTANT
   To run  the examples,  you need to  set the the  path to  the =lib=
   directory  into your  =LD_LIBRARY_PATH=  environment variable,  for
   instance:
  #+END_IMPORTANT

   #+BEGIN_SRC
export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:${PWD}/lib
   #+END_SRC
   
* Conventions

** General

   - All data is stored in atomic units.
   - All the words used are given in singular
   - The =num= suffix  denotes the number. For  example =apple_num= is
     the number of apples
   - All dimensioning variables should be 64-bit integers (=integer*8=
     in Fortran)
   - All variables corresponding  to an address in an  array should be
     64-bit integers

** Atomic orbitals (AOs)

    By definition, AOs are centered on nuclei. To enable the centering
    of AOs in  arbitrary positions, one can define dummy  atoms in the
    =nuclei= section.

    The AOs can be expressed in spherical or in cartesian coordinates,
    and are stored  as shells.

    \[ chi_k(r_k,\theta_k,\phi_k) = \mathcal{N}_k
       Y^k_{lm}(\theta_k,\phi_k)\, R(r_k)
    \]

    \[ chi_k(x_k,y_k,z_k) = \mathcal{N}_k x_k^a\, y_k^b\, z_k^c\,
       R(x_k,y_k,z_k) ) \]

    where $r_k,  \theta_k, \phi_k$ and  $x_k, y_k, z_k$  are expressed
    with respect to the center of the AO.
    
    $\mathcal{N}_k$  is a  multiplicative constant,  which can  be the
    normalization coefficient of the AO.

    $R(r_k)$ is a spherically symmetric function describing the radial
    behavior of the AO (Gaussian or Slater). 

    $\Y^k_{lm}$ are the real spherical harmonics, as expressed [[https://en.wikipedia.org/wiki/Table_of_spherical_harmonics][here]].

    The full AO basis can be expanded according to the fixed orders of
    angular functions. For real spherical harmonics, the order is $-l,
    \dots, 0,  \dots, l$.  For cartesian functions,  the order  is the
    alphanumeric order of the string built as =a*"x"+b*"y"+c*"z"=. For
    instance the polynomial $x^3yz^2$ is expressed as ="xxxyzz"=.

    
*** Gaussian orbitals

    With Gaussian orbitals, the radial part is expressed as

    \[ R(r_k) = \sum_i p_{ik} \exp(-\alpha_{ik} r_k^2) \]

    \[ R(r_k) = \sum_i p_{ik} \exp(-\alpha_{ik} (x_k^2+y_k^2+z_k^2) ) \]


*** Slater orbitals

    With Slater orbitals, the radial part is expressed as

    \[ R(r_k) = r_k^n \sum_i p_{ik} \exp(-\zeta_{ik} r_k) \]

    \[ R(r_k) = (x_k^2+y_k^2+z_k^2)^{n/2} \sum_i p_{ik}
                   \exp(-\zeta_{ik} (x_k^2+y_k^2+z_k^2)^{1/2} ) \]


** TODO Molecular orbitals (MOs)

   The MOs are expanded on the /normalized/ atomic basis set:

   \[ \varphi_i(r) = \sum_k c_{ki} \chi_k(r) \]

* Helper functions
  
** Periodic table

*** =trexio_element_name_of_symbol=
    Returns the name of an element from its symbol

*** =trexio_element_number_of_symbol=
    Returns the atomic number of an element from its symbol

*** =trexio_element_symbol_of_number=
    Returns the symbol of an element from its atomic number

    
** Spherical to cartesian coordinates transformation
   
   The transformation matrix from the  AO basis expressed in spherical
   coordinates to the AO basis  expressed in cartesian coordinates can
   be retrieved, as well as its pseudo-inverse.
   
* Acknowledgments

[[https://trex-coe.eu/sites/default/files/inline-images/euflag.jpg]]
[[https://trex-coe.eu][TREX: Targeting Real Chemical Accuracy at the Exascale]]
project has received funding from  the European Unionâ€™s Horizon 2020 -
Research and  Innovation program -  under grant agreement  no. 952165.
The content  of this document  does not  represent the opinion  of the
European Union, and the European Union  is not responsible for any use
that might be made of such content.

